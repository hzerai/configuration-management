<div>
  <div class="d-flex align-items-center mb-1" style="position: relative">
    <div style="position: absolute; left: -25px" id="expand-no-expand">
      <div *ngIf="expand == 'A'" (click)="expand = 'B'" role="button">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          fill="currentColor"
          class="bi bi-chevron-right"
          viewBox="0 0 16 16"
        >
          <path
            fill-rule="evenodd"
            d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"
          />
        </svg>
      </div>
      <div *ngIf="expand == 'B'" (click)="expand = 'C'" role="button">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          fill="currentColor"
          class="bi bi-chevron-down"
          viewBox="0 0 16 16"
        >
          <path
            fill-rule="evenodd"
            d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"
          />
        </svg>
      </div>
      <div *ngIf="expand == 'C'" (click)="expand = 'A'" role="button">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          fill="currentColor"
          class="bi bi-chevron-double-down"
          viewBox="0 0 16 16"
        >
          <path
            fill-rule="evenodd"
            d="M1.646 6.646a.5.5 0 0 1 .708 0L8 12.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"
          />
          <path
            fill-rule="evenodd"
            d="M1.646 2.646a.5.5 0 0 1 .708 0L8 8.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"
          />
        </svg>
      </div>
    </div>
    <div style="width: 13px; height: 13px" class="border mt-1 bg-warning"></div>
    <div class="w-100 d-flex justify-content-between fw-bold ms-1">
      <div>{{ identifier }}</div>
      <div>
        <span
          style="width: 150px"
          class="badge rounded-pill bg-warning text-secondary"
          >{{
            dirtyKeys.length +
              " field" +
              (dirtyKeys.length > 1 ? "s changed" : " changed")
          }}</span
        >
      </div>
    </div>
  </div>
  <table
    *ngIf="expand !== 'A'"
    class="table table-bordered border-dark table-hover caption-top"
  >
    <caption>
      {{
        expand == "B" ? "Showing modified keys only" : "Showing all keys"
      }}
    </caption>
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Column</th>
        <th scope="col">Old value</th>
        <th scope="col">New Value</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let key of allKeys; let i = index">
        <th
          class="table-light"
          *ngIf="(dirtyKeys.includes(key) && expand == 'B') || expand == 'C'"
          scope="row"
        >
          {{ i }}
        </th>
        <td
          class=" {{ dirtyKeys.includes(key) ? 'active' : 'text-secondary' }}"
          *ngIf="(dirtyKeys.includes(key) && expand == 'B') || expand == 'C'"
        >
          {{ key }}
        </td>
        <td
          *ngIf="(dirtyKeys.includes(key) && expand == 'B') || expand == 'C'"
          class=" {{ dirtyKeys.includes(key) ? 'active' : 'text-secondary' }}"
        >
          {{ old[key] }}
        </td>
        <td
          *ngIf="(dirtyKeys.includes(key) && expand == 'B') || expand == 'C'"
          class=" {{ dirtyKeys.includes(key) ? 'active' : 'text-secondary' }}"
        >
          {{ new[key] }}
        </td>
      </tr>
    </tbody>
  </table>

  <!-- <div *ngFor="let key of allKeys">
    <div
      *ngIf="(dirtyKeys.includes(key) && expand == 'B') || expand == 'C'"
      class="row rounded-bottom"
    >
      <div
        class="col-2 border {{
          dirtyKeys.includes(key) ? 'bg-warning' : 'bg-secondary'
        }}"
      >
        {{ key }}
      </div>
      <div
        class="col-5 border {{
          dirtyKeys.includes(key) ? 'bg-warning' : 'bg-secondary'
        }}"
      >
        {{ old[key] }}
      </div>
      <div
        class="col-5 border {{
          dirtyKeys.includes(key) ? 'bg-warning' : 'bg-secondary'
        }}"
      >
        {{ new[key] }}
      </div>
    </div>
  </div> -->
</div>
