<div class="w-75 mx-auto mt-5">
  <div style="height: 400px">
    <div
      class="rounded px-2 py-2 mt-3"
      style="margin-inline: 7rem; z-index: 11"
    >
      <div class="input-group mb-1">
        <span class="input-group-text" style="width: 35%">Repository</span>
        <input
          (change)="refreshBranches()"
          [disabled]="this.current_configuration.git.valid"
          [(ngModel)]="this.current_configuration.git.repository"
          type="text"
          class="form-control"
        />
      </div>
      <div class="input-group mb-1">
        <span class="input-group-text" style="width: 35%">Branch</span>
        <select
          [disabled]="
            !this.current_configuration.git.repository ||
            this.current_configuration.git.valid
          "
          [(ngModel)]="this.current_configuration.git.branch"
          class="form-select"
          aria-label="select branch"
        >
          <option disabled value="select a branch">
            {{
              !this.current_configuration.git.repository
                ? "Select your repository first..."
                : "Select branch"
            }}
          </option>
          <option *ngFor="let branch of branches" value="{{ branch }}">
            {{ branch }}
          </option>
        </select>
      </div>

      <div class="d-flex align-items-center ms-2 my-1">
        <small><b>Advanced settings</b></small>
        <div id="expand-no-expand" class="ms-2 mb-1 fw-bold">
          <div *ngIf="advanced" (click)="advanced = !advanced" role="button">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="12"
              height="12"
              fill="currentColor"
              class="bi bi-chevron-down"
              viewBox="0 0 16 16"
            >
              <path
                fill-rule="evenodd"
                d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"
              />
            </svg>
          </div>
          <div *ngIf="!advanced" (click)="advanced = !advanced" role="button">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="12"
              height="12"
              fill="currentColor"
              class="bi bi-chevron-right"
              viewBox="0 0 16 16"
            >
              <path
                fill-rule="evenodd"
                d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"
              />
            </svg>
          </div>
        </div>
      </div>
      <div *ngIf="advanced">
        <div class="input-group mb-1">
          <span class="input-group-text" style="width: 35%"
            >Configuration's folder</span
          >
          <input
            [disabled]="this.current_configuration.git.valid"
            [(ngModel)]="this.current_configuration.git.folder.name"
            type="text"
            class="form-control"
            (change)="refreshAttributes()"
          />
        </div>
        <div class="input-group mb-1">
          <span class="input-group-text" style="width: 35%"
            >Configuration's tables file</span
          >
          <input
            [disabled]="true"
            [(ngModel)]="this.current_configuration.git.tables.name"
            type="text"
            class="form-control"
          />
        </div>
        <div class="input-group mb-1">
          <span class="input-group-text" style="width: 35%"
            >SQL Triggers folder</span
          >
          <input
            [disabled]="true"
            [(ngModel)]="this.current_configuration.git.triggers.name"
            type="text"
            class="form-control"
          />
        </div>
        <div class="input-group mb-1">
          <span class="input-group-text" style="width: 35%"
            >JSON Baseline folder</span
          >
          <input
            [disabled]="true"
            [(ngModel)]="this.current_configuration.git.baseline.name"
            type="text"
            class="form-control"
          />
        </div>
        <div class="input-group mb-1">
          <span class="input-group-text" style="width: 35%"
            >Delivery folder</span
          >
          <input
            [disabled]="true"
            [(ngModel)]="this.current_configuration.git.delivery.name"
            type="text"
            class="form-control"
          />
        </div>
      </div>
      <div *ngIf="message">
        <div class="mt-2">
          <div class="alert alert-success py-1" role="alert">
            {{ this.message }}
          </div>
        </div>
      </div>
    </div>
  </div>
  <div
    class="d-grid gap-2 d-md-flex justify-content-md-end mt-4"
    style="position: relative"
  >
    <a
      href="/"
      class="btn btn-secondary"
      style="left: 0px; position: absolute"
      type="button"
      >Back</a
    >

    <button
      *ngIf="this.current_configuration.git.valid"
      (click)="this.current_configuration.git.valid = false"
      class="btn btn-info me-md-2"
      type="button"
    >
      Edit git configuration
    </button>
    <button
      *ngIf="!this.current_configuration.git.valid"
      (click)="validateGitConnection()"
      class="btn btn-success me-md-2"
      type="button"
    >
      Test git connectivity
    </button>
    <button
      [disabled]="!this.current_configuration.git.valid"
      (click)="step()"
      class="btn btn-primary"
      type="button"
    >
      Next
    </button>
  </div>
</div>
