<div class="w-75 mx-auto mt-5 overflow-hidden">
  <div style="height: 400px">
    <div
      class="rounded px-2 py-2 h-100"
      style="margin-inline: 7rem; z-index: 11"
    >
      <div *ngIf="!loaded">
        <div class="d-flex">
          <p class="fw-bold" style="width: 28%">Tables metadata source :</p>
          <div class="d-flex justify-content-between" style="width: 72%">
            <div class="form-check ms-5">
              <input
                (change)="resetTables()"
                [value]="'GIT'"
                [(ngModel)]="tables_source"
                class="form-check-input"
                type="radio"
                name="tables_source"
                id="GIT"
              />
              <label class="form-check-label" for="GIT"
                >GIT
                <img src="assets\img\git-lab.png" width="30px" class="" />
              </label>
            </div>
            <div class="form-check">
              <input
                (change)="resetTables()"
                [value]="'FILE'"
                [(ngModel)]="tables_source"
                class="form-check-input"
                type="radio"
                name="tables_source"
                id="FILE"
              />
              <label class="form-check-label" for="FILE">
                File
                <img src="assets\img\file.png" width="26px" />
              </label>
            </div>
            <div class="form-check">
              <input
                (change)="resetTables()"
                [value]="'DB'"
                [(ngModel)]="tables_source"
                class="form-check-input"
                type="radio"
                name="tables_source"
                id="DB"
              />
              <label class="form-check-label" for="DB">
                DB
                <img src="assets\img\db-dark.png" width="20px" />
              </label>
            </div>
            <div class="form-check">
              <input
                (change)="resetTables()"
                [value]="'API'"
                [(ngModel)]="tables_source"
                class="form-check-input"
                type="radio"
                name="tables_source"
                id="API"
              />
              <label class="form-check-label" for="API">
                API
                <img src="assets\img\api-dark.png" width="23px" />
              </label>
            </div>
          </div>
        </div>
      </div>
      <div *ngIf="!all_tables && !tables_loading" class="w-100 h-100">
        <div *ngIf="!tables_source" class="fs-5">
          <button
            disabled
            type="submit"
            class="btn btn-light w-100 fw-bold"
          >
            Select source
          </button>
        </div>
        <div *ngIf="tables_source == 'FILE'" class="">
          <div class="mb-3">
            <label
              for="tablesFromFileInput"
              type="submit"
              class="btn btn-light w-100 fw-bold"
            >
              Load
              <img src="assets\img\file.png" width="25px" class="ms-3" />
            </label>
            <input
              (change)="loadFromFile($event)"
              class="form-control form-control-sm"
              id="tablesFromFileInput"
              type="file"
              style="display: none"
            />
          </div>
        </div>
        <div *ngIf="tables_source == 'DB'" class="">
          <button
            (click)="loadFromDB()"
            type="submit"
            class="btn btn-light w-100 fw-bold"
          >
            Load
            <img src="assets\img\db.png" width="20px" class="ms-3" />
          </button>
        </div>
        <div *ngIf="tables_source == 'GIT'" class="">
          <div class="input-group input-group-sm mb-3">
            <span
              class="input-group-text bg-primary text-light fw-bold"
              style="width: 100%"
              id="inputGroup-sizing-sm"
              >{{
                "https://git.vermeg.com/" +
                  this.current_configuration.git.repository +
                  this.current_configuration.git.tables?.name
              }}</span
            >
          </div>
          <button
            (click)="loadFromGit()"
            type="submit"
            class="btn btn-light w-100 fw-bold"
          >
            Load
            <img src="assets\img\git-lab.png" width="28px" class="ms-3" />
          </button>
        </div>
        <div *ngIf="tables_source == 'API'" class="">
          <div class="input-group input-group-sm mb-3">
            <span
              class="input-group-text bg-primary text-light fw-bold"
              style="width: 15%"
              id="inputGroup-sizing-sm"
              >link</span
            >
            <input
              [(ngModel)]="apiLink"
              type="text"
              class="form-control"
              aria-label="Sizing example input"
              aria-describedby="inputGroup-sizing-sm"
            />
          </div>
          <button
            [disabled]="!apiLink"
            (click)="loadFromAPI()"
            type="submit"
            class="btn btn-light w-100 fw-bold"
          >
            Load
            <img src="assets\img\api.png" width="20px" class="ms-3" />
          </button>
        </div>
      </div>
      <div
        *ngIf="tables_loading"
        class="d-flex flex-column justify-content-center align-items-center"
      >
        <div class="spinner-border" role="status" aria-hidden="true"></div>
        <small>Loading tables</small>
      </div>
      <div *ngIf="all_tables">
        <div class="d-flex">
          <div class="w-50">
            <div class="input-group rounded" style="position: relative">
              <input
                (keyup)="allTableFilter()"
                type="search"
                class="w-100 p-2 rounded bg2  border-0 me-1"
                [(ngModel)]="allTablesSearch"
                (click)="allTableFilter()"
              />
              <svg
                style="position: absolute; right: 8px; top: 30%; color: gray"
                xmlns="http://www.w3.org/2000/svg"
                width="18"
                height="18"
                fill="currentColor"
                class="bi bi-search"
                viewBox="0 0 16 16"
              >
                <path
                  d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"
                />
              </svg>
            </div>
            <div style="max-height: 300px; overflow-y: auto">
              <table class="table table-striped table-dark  table-hover">
                <tbody>
                  <tr
                    class="rounded"
                    *ngFor="let table of all_tables_temps_filtered"
                  >
                    <td scope="row">
                      <div
                        class="d-flex justify-content-between align-items-center"
                      >
                        <div>{{ table.table }}</div>
                        <svg
                          role="button"
                          (click)="add(table)"
                          xmlns="http://www.w3.org/2000/svg"
                          width="20"
                          height="20"
                          fill="currentColor"
                          class="text-success bi bi-plus-square-fill"
                          viewBox="0 0 16 16"
                        >
                          <path
                            d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm6.5 4.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3a.5.5 0 0 1 1 0z"
                          />
                        </svg>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="w-50">
            <div class="input-group rounded" style="position: relative">
              <input
                (keyup)="selectedTableFilter()"
                type="search"
                class="w-100 p-2 rounded bg2  border-0 ms-1"
                [(ngModel)]="selectedTablesSearch"
                (click)="selectedTableFilter()"
              />
              <svg
                style="position: absolute; right: 8px; top: 30%; color: gray"
                xmlns="http://www.w3.org/2000/svg"
                width="18"
                height="18"
                fill="currentColor"
                class="bi bi-search"
                viewBox="0 0 16 16"
              >
                <path
                  d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"
                />
              </svg>
            </div>
            <div style="max-height: 300px; overflow-y: auto">
              <table class="table table-dark table-striped table-hover">
                <tbody>
                  <tr
                    class="rounded"
                    *ngFor="let table of selected_tables_filtered"
                  >
                    <td scope="row">
                      <div
                        class="d-flex justify-content-between align-items-center"
                      >
                        <svg
                          role="button"
                          (click)="remove(table)"
                          xmlns="http://www.w3.org/2000/svg"
                          width="27"
                          height="22"
                          fill="currentColor"
                          class="text-danger bi bi-file-minus-fill"
                          viewBox="0 0 16 16"
                        >
                          <path
                            d="M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM6 7.5h4a.5.5 0 0 1 0 1H6a.5.5 0 0 1 0-1z"
                          />
                        </svg>
                        <div>{{ table.table }}</div>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="w-100 d-flex justify-content-center mt-4">
    <div class="btn-group">
      <button
        (click)="step_back()"
        class="btn btn-light mx-1 px-5 fw-bold"
        type="button"
      >
        Back
      </button>

      <button
        [disabled]="selected_tables.length == 0"
        (click)="step()"
        class="btn btn-primary mx-1 px-5 fw-bold"
        type="button"
      >
        Next
      </button>
    </div>
  </div>
</div>
